{{ define "main" }}

  <h1 class="title">Layoutseite: articles/single.html</h1>
 
  <div class="content">
    <div class="columns">
      <div class="column box">
        <article>
          {{ if .Params.icons }}
            <h2>Details</h2>
            {{ range .Params.icons }}
              <span {{ if .tooltip }}data-tooltip="{{ .tooltip }}"{{ end }} style="font-size: 3em; color: {{ .color }};">
                <i class="{{ .src }}"></i>
              </span>
            {{ end }}
          {{ end }}
          {{ .Content }}
        </article>
      </div>
      
      <div class="column is-3">
        <div class="box">
        <p class="title">Information</p>
          <div class="date-single">
            <time datetime="{{ .PublishDate.Format "2006-01-02T15:04:05Z07:00" }}">
              {{ .PublishDate.Day }}. {{ index $.Site.Data.demonths (printf "%d" .PublishDate.Month) }} {{ .PublishDate.Year }}
            </time>
            <br />
            <time datetime="{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}">
              Updated: {{ .Lastmod.Day }}. {{ index $.Site.Data.demonths (printf "%d" .Lastmod.Month) }} {{ .Lastmod.Year }}
            </time>
          </div>

          <div class="author-single is-clearfix">
            {{ range (.GetTerms "authors") }}
              <figure class="image is-48x48 is-pulled-left">
                <a href="{{ .Permalink }}">
                  {{- range first 1 (.Resources.ByType "image") -}}
                    {{- $img := .Fill "48x48" | images.Filter images.Grayscale -}}
                    <img class="is-rounded" src="{{ $img.RelPermalink }}" alt="{{ $.Title }}">
                  {{- end -}}
                </a>
              </figure>
              <a class="is-pulled-right" href="{{ .Permalink }}">{{ .Title }}</a>
            {{ end }}
          </div>
          {{- if .Params.categories -}}
          <div class="categories-single">Kategorie:
              {{- range (.GetTerms "categories") -}}
                <a href="{{ .Permalink }}"><span class="tag is-primary">{{ .LinkTitle }}</span></a>
              {{- end -}}
            </div>
          {{- end -}}
          {{- if .Params.tags -}}
            <div class="tags-single">Tags:
              {{- range (.GetTerms "tags") -}}
                <a href="{{ .Permalink }}"><span class="tag">{{ .LinkTitle }}</span></a>
              {{- end -}}
            </div>
          {{- end -}}
          <div class="reading-time-single">Leseminuten: {{ .ReadingTime }} {{ i18n "minutesRead" }}</div>

          {{- if .Params.rating -}}
            <div class="rating">Rating: {{ partial "rating" . }} {{ .Params.rating }}</div>
          {{- end -}}

          {{ if .Params.series }}
            <div class="series-single">Serie:
              {{ $name := index .Params.series 0 }}
              This post is part of the <a href="{{.Site.BaseURL}}/series/{{$name | urlize}}">{{$name}}</a> series.
            </div>
          {{ end }}
        </div>

        {{ if ge (len .TableOfContents) 100 }}
          <div class="box">
            <p class="title">Table of Content</p>
            {{ .TableOfContents }}
          </div>
        {{ end }}
        
        {{ if .Params.series }}
          <div class="box">
            <p class="title">Serie</p>

            {{- $currentPage := . -}}
            {{- $series_name := index .Params.series 0 -}}
            {{- range .Site.RegularPages.ByDate -}}
              {{- if in .Params.series $series_name -}}

                {{- if not (eq $currentPage.RelPermalink .RelPermalink) -}}
                  <a href="{{ .RelPermalink }}" title="{{ .Name }} page"><li>{{ .PublishDate.Format "02-01-2006" }} - {{ .Title }}</li></a>
                {{- else -}}
                  <li class="is-active">{{ .PublishDate.Format "02-01-2006" }} - {{ .Title }}</li>
                {{- end -}}
                
              {{- end -}}
            {{- end -}}
            
          </div>
        {{ end }}

      </div>
    </div>

    {{ if .Params.series }}
      <div class="columns">
        <div class="column is-9 box">
          {{ partial "series-footer" . }}
        </div>
      </div>
    {{ end }}

  </div>

  {{ if .Params.authors }}
    <div class="columns">
      <div class="column is-9 card-horiz-img is-paddingless">

          <article class="card is-horizontal">
            {{ range (.GetTerms "authors") }}
              <div class="card-image">
                <!-- // HACK: Is this right? -->
                <figure class="image is-2by3">
                  <a href="{{ .Permalink }}">
                    {{- range first 1 (.Resources.ByType "image") -}}
                      {{- $img := .Fill "320x480" | images.Filter (images.Sepia "100") -}}
                      <img src="{{ $img.RelPermalink }}" alt="{{ $.Title }}">
                    {{- end -}}
                  </a>
                </figure>
              </div>
          
              <div class="card-content">
                <div class="card-content-wrapper">
                  <div class="media-content">
                    <a class="title is-4" href="{{ .RelPermalink }}"><h2>{{ .Title }}</h2></a>
                    
                    <span class="heading">
                      Birthdate: {{ .Params.birthdate }}
                    </span>
                  </div>
              
                  <div class="content">
                    {{ .Content }}
                  </div>
                
                  <footer class="card-footer">
                    {{ range .Params.socials }}
                      <span class="card-footer-item"><a data-tooltip="{{ .name }}" href="{{ .src }}"><i class="fab fa-{{ .name }}-square fa-3x"></i></a></span>
                    {{ end }}
                  </footer>
                </div>
              </div>
            {{ end }}
          </article>

      </div>
    </div>
  {{ end }}

  <!-- THANKS: https://www.pakstech.com/blog/hugo-related-pages/ -->
 
  {{ if len (where (.Site.RegularPages.Related .) "Type" "articles") }}
    <div class="columns">
      <div class="column is-9 is-paddingless" >
        <div class="content">
          <h2>Related content</h2>
        </div>
        <div class="columns">
          {{- $related := (where (.Site.RegularPages.Related .) "Type" "articles") | first 3 -}}
          {{- range $related -}}
            <div class="column is-one-third is-flex">
              <div class="card">
                <div class="card-image">
                  <figure class="image is-3by2">
                    {{- range first 1 (.Resources.ByType "image") -}}
                      {{- $img := .Fill "480x320" | images.Filter (images.Sepia "100") -}}
                      <a href="#">
                        <img src="{{ $img.RelPermalink }}" alt="{{ $.Title }}">
                      </a>
                    {{- end -}}
                    {{- with .Params.images -}}
                      {{ range first 1 . }}<figcaption>Byline: {{ .byline | safeHTML }}</figcaption>{{ end }}
                    {{- end -}}
                  </figure>
                </div>
                <div class="card-content">
                  <a class="title is-5" href="{{ .Permalink }}">{{ .Title }}</a>
                  <span class="heading"><time>
                    {{ .PublishDate.Day }}. {{ index $.Site.Data.demonths (printf "%d" .PublishDate.Month) }} {{ .PublishDate.Year }}
                  </time></span>
                </div>
              </div>
            </div>
          {{- end -}}
        </div>
      </div>
    </div>
  {{ end }}
 
{{ end }}
