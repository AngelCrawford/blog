<article class="card {{ if .Resources }}is-horizontal{{else}}no-image{{ end }}">
  {{ if .GetTerms "categories" }}
    {{ range first 1 (.GetTerms "categories") }}
      {{ $catName := .LinkTitle }}
      <div class="ribbon is-primary" style="{{ range .Site.Params.categoryColor }}{{ if eq .name $catName }}background-color: {{ .color }};{{ end }}{{ end }}">
          <a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a>
      </div>
    {{ end }}
  {{ end }}

  {{ if .Resources }}
    <div class="card-image has-ribbon">
      <!-- // HACK: Is this right? -->
      <figure class="image is-2by3">
        <a href="{{ .Permalink }}">
          {{- range first 1 (.Resources.ByType "image") -}}
            {{- $img := .Fill "320x480" | images.Filter (images.Sepia "100") -}}
              <img src="{{ $img.RelPermalink }}" alt="{{ $.Title }}">
          {{- end -}}
        </a>
        {{- with .Params.images -}}
          {{ range first 1 . }}<figcaption>Byline: {{ .byline | safeHTML }}</figcaption>{{ end }}
        {{- end -}}
      </figure>
    </div>
  {{ end }}

  <div class="card-content">
    <div class="card-content-wrapper">
      <div class="media-content">
        <a class="title is-4" href="{{ .RelPermalink }}"><h2>{{ .Title }}</h2></a>

        <span class="heading">
          <time datetime="{{ .PublishDate.Format "2006-01-02T15:04:05Z07:00" }}">
            <i class="far fa-calendar-alt"></i> {{ .PublishDate.Day }}. {{ index $.Site.Data.demonths (printf "%d" .PublishDate.Month) }} {{ .PublishDate.Year }}
          </time>
          <time class="updated" datetime="{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}">
            <i class="fas fa-pencil-alt"></i> {{ .Lastmod.Format "02.01.06" }}
          </time>
        </span>
      </div>
  
      <div class="content">
        {{- if .Params.rating -}}
          <div class="rating">{{ partial "rating" . }}</div>
        {{- end -}}

        {{ if eq .Params.weight 1 }}
          <!-- // FIXME: Wenn ich Content hier verwende, dann wird "summary" im Frontend nicht benutzt -->
          {{ if .Params.summary }}
            {{ .Summary | truncate 800 " [...]" }}
          {{ else }}
            {{ .Content | truncate 800 " [...]" | markdownify }}
          {{ end }}
        {{ else if not .Resources }}
          {{ .Summary | truncate 500 " [...]" }}
        {{ else }}
          {{ .Summary | truncate 280 " [...]" }}
        {{ end }}
        
        <a href="{{ .RelPermalink }}">{{ i18n "readMore" }}</a>

        {{- if (.GetTerms "tags") -}}
          <div class="tags-wrapper"><i class="fas fa-tags"></i>
            {{- range (.GetTerms "tags") -}}
              <a href="{{ .RelPermalink }}" class="hashtags">#{{ .LinkTitle }} </a> 
            {{- end -}}
          </div>
        {{- end -}}

      </div>

      <div class="author-img {{ if .Resources }}post-has-image{{ end }}">
        {{ range (.GetTerms "authors") }}
          <figure class="image is-48x48">
            <a href="{{ .Permalink }}">
              {{- range first 1 (.Resources.ByType "image") -}}
                {{- $img := .Fill "48x48" | images.Filter images.Grayscale -}}
                <img class="is-rounded" src="{{ $img.RelPermalink }}" alt="{{ $.Title }}">
              {{- end -}}
            </a>
          </figure>
        {{ end }}
      </div>
    
      <footer class="card-footer">
        <span class="card-footer-item">{{ .ReadingTime }} {{ i18n "minutesRead" }}</span>
        <span class="card-footer-item">
          
          {{ if .Params.weight }}<i class="fas fa-thumbtack"></i>{{ end }}
          <i class="far fa-newspaper"></i>
          {{ if .Params.rating }}<i class="fas fa-film"></i>{{ end }}
          {{ if .Params.series }}<i class="fas fa-layer-group"></i>{{ end }}
          
          {{ range (.GetTerms "contains") }}
            {{ if eq .Title "code" }}<i class="fas fa-code"></i>{{ end }}
            {{ if eq .Title "instagram" }}<i class="fab fa-instagram"></i>{{ end }}
            {{ if eq .Title "twitter" }}<i class="fab fa-twitter"></i>{{ end }}
            {{ if eq .Title "youtube" }}<i class="fab fa-youtube"></i>{{ end }}
            {{ if eq .Title "image" }}<i class="fas fa-camera"></i>{{ end }}
            {{ if eq .Title "gallery" }}<i class="far fa-images"></i>{{ end }}
            {{ if eq .Title "comment" }}<i class="far fa-comments"></i>{{ end }}
          {{ end }}
        </span>
      </footer>

    </div>
  </div>
</article>